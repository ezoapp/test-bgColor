!function(e,t){"use strict";function n(e){return e.replace(/<!--[\s\S]*?-->/gm,"").replace(/>\s+</gm,"><")}function r(e){return e.replace(/\s*(\r\n|\n|\r)\s*/gm,"")}function i(e,t,n){return t=m(t,e+"/../"),t.substr(0,t.length-n.length-1)}function u(e,t){var n=function(e,n){t.deps.push(e),n&&t.vars.push(n)};e.each(function(e,r){var u=r.getAttribute("path"),s=r.getAttribute("src"),l=r.getAttribute("var");u?n(u,l):s?(s=i(t.moduleId,s,"js"),n(s,l)):t.script+=r.text})}function s(e,t){e.each(function(e,n){var r=n.getAttribute("rel"),u=n.getAttribute("href");u&&("import"===r?t.deps.push("@html!"+i(t.moduleId,u,"html")):"stylesheet"===r&&t.deps.push("@css!"+i(t.moduleId,u,"css")))})}function l(e,i){var u;e.length&&(e=t("<div>"+e[0].innerHTML+"</div>"),u=e.children("link"),s(u,i),u.remove(),i.template=n(r(e[0].innerHTML)))}function o(e,t){var n=function(e){return"function registerElement(n,c){$.gk.registerElement(n,'"+e+"',c)}"};t.moduleText=n(t.template)+(e.length?e[0].text:"")}function c(e){return'var moduleId="'+e.moduleId+'";'+r(e.script)+"define("+JSON.stringify(e.deps)+", function("+e.vars.join()+"){"+e.moduleText+"});"}function d(e,n){var r=t("<div>"+e+"</div>"),i=r.children("script"),d=r.children("link"),p=r.children("element"),a=p.children("template"),f=p.children("script");return u(i,n),s(d,n),l(a,n),o(f,n),c(n)}var p={dirname:function(e,t){return e.split("?")[0].split("/").slice(0,t||-1).join("/")},normalize:function(e){var t,n=e.split("://"),r="",i=[];for(n.length>1&&(r=n[0]+"://"+n[1].split("/")[0],e=e.substr(r.length)),e=e.replace(/\/+/g,"/"),0===e.indexOf("/")&&(r+="/",e=e.substr(1)),n=e.split("/");t=n.shift();)".."===t?i.pop():"."!==t&&i.push(t);return r+i.join("/")},isAbsolute:function(e){return e=e.toLowerCase(),0===e.indexOf("http://")||0===e.indexOf("https://")||0===e.indexOf("data:")||"/"===e[0]},absolute:function(e,t){return p.isAbsolute(e)||(e=p.normalize((t||"")+"/"+e)),e}},a=".html",f=p.normalize,m=p.absolute;t.gk.registerElement=function(e,n,r){t.gk.registry(e,{template:n,script:function(){for(var e=Object.keys(r||{}),t=0,n=e.length;n>t;t+=1)this[e[t]]=r[e[t]]}})},e({load:function(e,t,n){t(["@text!"+e+a],function(t){var r={deps:["require","exports","module"],vars:["require","exports","module"],moduleId:e,template:"",moduleText:"",script:""};n.fromText(d(t,r))})},normalize:f,pluginBuilder:"./builder"})}(define,jQuery);