!function(e,t){var n=e.jQuery;n&&t(e,e.document,n)}(window,function(e,t,n){var r=function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},i=function(){function e(e){this.id=e,this.$ele=n("#"+this.id),this.$originEle=n(a.tag[this.id])}var r=e.prototype;return r.beforeParse=function(e){return e},r.bindEvent=function(){var e=this,n=t.getElementById(this.id);if(null!=n)for(var r=0,i=n.attributes.length;i>r;r++){var o=n.attributes[r];if(0==o.name.indexOf("data-gk-")){var a=o.name.substring(8);this.$ele.unbind(a),this.$ele.bind(a,e["on"+a])}}},e}(),o=function(){var e={},r=t.createElement("div");return e.safeDocumentFrag=t.createDocumentFragment(),e.safeDocumentFrag.appendChild(r),e.createElement=function(r){n.support.leadingWhitespace||(t.createElement(r),e.safeDocumentFrag.createElement(r))},e.createDIVWrapper=function(e){var t;return r.innerHTML="<div>"+e+"</div>",r.removeChild(t=r.firstChild),t},e.cloneNode=function(e){var t;return n.support.leadingWhitespace?t=e.cloneNode(!0):(r.innerHTML=e.outerHTML,r.removeChild(t=r.firstChild)),t},e.replaceElement=function(e,t){for(var n=e.parentNode;null!=t;){var r=t.nextSibling;n.insertBefore(t,e),t=r}n.removeChild(e)},e.toElement=function(t){var n=e.createDIVWrapper(t);return n.firstChild},e.innerHTML=function(e){var t="",n=e;if(null!=n){if(""!==e.innerHTML)return e.innerHTML;for(;n.nextSibling;)if(n=n.nextSibling,3===n.nodeType)t+=n.nodeValue.trim(),n.nodeValue="";else if(1===n.nodeType)break}return t},e}(),a=function(){var e={CLASS:"use",tag:{},PREFIX:"_gk_src_"};return e.replaceWith=function(t,r){if(undefined===r)return null;var i,a,s,u,p,l=o.cloneNode(c.customTags[t]),f=n(l),d=f.attr(this.CLASS)||"WebComponent",g=f.html();g=c.unDecorateSpecialAttr(g),a=undefined===r.id||""===r.id?r.id=c.getGenId():r.id,i="$.gk.com('"+a+"' , new $.gk.components['"+d+"']('"+a+"'));",c.eventStore.script.push(i),s=o.innerHTML(r),e.tag[a]=n(r).clone().wrap("<div></div>").parent().html().trim(),g=g.replace(c.content,s),g=n.gk.components[t].prototype.beforeParse(g);var m=[],h={};return n.each(r.attributes,function(e,t){0==t.nodeName.indexOf("on")&&m.push([t.nodeName,t.nodeValue]),h[t.nodeName]=t.nodeValue;var n=RegExp("{{"+t.nodeName+"}}","gi");g=g.replace(n,t.nodeValue)}),u=o.toElement(g),p=n(u),n.each(m,function(e,t){p.attr(t[0],t[1])}),n.each(h,function(t,n){p.data(e.PREFIX+t,n)}),p.addClass("gk-component-"+d.toLowerCase()),o.replaceElement(r,u),u},e}(),c=function(){var e={},t="style|class",r=RegExp("\\s+("+t+")(?==['\"].*?['\"]\\s?)","gi"),i=/\s+(?:data-gksa-(.*?))(?==['"].*?['"])/gi;return e.serial=0,e.customTags={},e.content=RegExp("<contents*>S*</content>","ig"),e.DATAKEY="_gk_",e.genIdPrefix="_gk_gen_",e.eventStore=[],e.eventStore.script=[],e.decorateSpecialAttr=function(e){return e=e.replace(r," data-gksa-$1"),r.lastIndex=0,e},e.unDecorateSpecialAttr=function(e){return e=e.replace(i," $1"),i.lastIndex=0,e},e.getGenId=function(){return this.genIdPrefix+this.serial++},e.isComponent=function(t){return e.customTags[t.toUpperCase()]},e.enhance=function(e){n(e).each(function(t,r){var i=n(r);"*[is]"===e&&(i=i.parent());var o=i.html();o="BODY"===i.prop("tagName")?o.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""):o,i.html(n.gk.toHTML(o))})},e.process=function(t){var r=n.type(t);if("null"!==r&&"undefined"!==r){var i=t.nodeName.toUpperCase();if("#"!==i.charAt(0)&&null!=t.getAttribute("is")&&(i=t.getAttribute("is").toUpperCase()),e.isComponent(i))e.process(a.replaceWith(i,t));else if(t.firstChild)e.process(t.firstChild);else if(t.nextSibling)e.process(t.nextSibling);else if(t.parentNode&&t.parentNode.parentNode){for(t=t.parentNode;null==t.nextSibling;){if(!t.parentNode)return;t=t.parentNode}e.process(t.nextSibling)}}},e}();n.gk={version:"0.6",components:{WebComponent:i},createTag:function(e){for(var t in e)o.createElement(e[t].replace(/\S*\//g,""))},init:function(){c.enhance("*[gk-app]"),c.enhance("*[is]"),n(t).triggerHandler("gkComponentsReady")},toHTML:function(e){var t,n,r=o.createDIVWrapper(e);return c.process(r),t=(c.eventStore.script||[]).join(" "),n=t.length>0?r.innerHTML+"<script>"+t+"<\/script>":r.innerHTML,c.eventStore.script=[],n.replace(/(\s(?!(data-gk-))[\w-]+=['"]\{\{[^\{\}]+\}\}['"])/g,"")},registry:function(e,t){if(null!=e&&"string"==typeof e){var o,a;"function"==typeof t?o=t():"object"==typeof t&&t.constructor===Object&&(o=t),o.name=e.toUpperCase(),a="<gk:view use='"+o.name+"'>"+o.template+"</gk:view>",a=c.decorateSpecialAttr(a),c.customTags[o.name]=n(a)[0];var s=function(e){i.call(this,e),o.script&&o.script.call(this),this.bindEvent.call(this)};r(s,i),o.beforeParse&&(s.prototype.beforeParse=o.beforeParse),s.prototype.template=o.template,n.gk.components[o.name]=s}},com:function(e,t){n("#"+e).data(c.DATAKEY,t),t.init&&t.init()}},n.fn.gk=function(e){if(0==arguments.length)return n(this).data(c.DATAKEY);var t=Array.prototype.slice.call(arguments,1),r=null;return this.each(function(i,o){var a=n(o).data(c.DATAKEY);if(a instanceof Object&&"function"===n.type(a[e])){var s=a[e].apply(a,t);0==i&&(r=s)}}),r},"function"==typeof define?(define("jquery",function(){return n}),define("gk",["jquery"],function(){return n.gk})):(e.define=function(){n.gk.registry.apply(this,arguments)},n(t).ready(function(){n.gk.init()}))});